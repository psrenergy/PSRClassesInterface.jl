//--------------------------------------
//--- Modelo para Hidro		         ---
//--------------------------------------
MERGE_CLASS PSRHydroPlant Optfolio_HydroPlant
	DIMENSION	block
	
  	VETOR 	DATE   	DataOptfolio
	VETOR 	DATE   	DataSensib
	VECTOR  REAL    FirmEnergy       INDEX DataOptfolio
	VECTOR	REAL 	FixedOEM         INDEX DataOptfolio
	VECTOR  REAL	CapRevenue       INDEX DataOptfolio
	VECTOR	REAL 	SensibPotInst	 INDEX DataSensib
	VECTOR  REFERENCE  Costs         Optfolio_GenericCosts
	PARM    INTEGER Included
	PARM	REAL	Percentage
	PARM	REAL	InternalLoss
	PARM	INTEGER flagMRE
	PARM 	INTEGER Contract
	PARM	INTEGER	RevPfirm
	PARM	INTEGER	RevGF
	PARM	INTEGER DecisionType
	PARM	INTEGER DecisionVar
	PARM	DATE	MinCOD
	PARM	INTEGER CODInterval
	PARM	INTEGER	IsCandidate
	PARM	REAL	GridLoss
	
END_CLASS

//--------------------------------------
//--- Modelo para Renovavel		     ---
//--------------------------------------
MERGE_CLASS PSRGndPlant Optfolio_GndPlant
	DIMENSION	block
	
  	VETOR 	DATE   	DataOptfolio
	VETOR 	DATE   	DataSensib
	VECTOR  REAL    FirmEnergy       INDEX DataOptfolio
	VECTOR	REAL 	FixedOEM         INDEX DataOptfolio
	VECTOR  REAL	CapRevenue       INDEX DataOptfolio
	VECTOR	REAL 	SensibPotInst	 INDEX DataSensib
	VECTOR  REFERENCE  Costs         Optfolio_GenericCosts
	PARM    INTEGER Included
	PARM	REAL	Percentage
	PARM	REAL	InternalLoss
	PARM	REAL	GridLoss
	PARM 	INTEGER Contract
	PARM 	INTEGER Ballast
	PARM	INTEGER	RevPfirm
	PARM	INTEGER	RevGF
	PARM	INTEGER DecisionType
	PARM	INTEGER DecisionVar
	PARM	DATE	MinCOD
	PARM	INTEGER CODInterval
	PARM	INTEGER	IsCandidate
	
// See later:	VECTOR	REAL	FixedOEMCost	DIM(block)
END_CLASS

//--------------------------------------
//--- Modelo para Gera  o Termica    ---
//--------------------------------------
MERGE_CLASS PSRThermalPlant Optfolio_ThermalPlant
	DIMENSION	block
  	VETOR 	DATE   	DataOptfolio
	VETOR 	DATE   	DataSensib
	VECTOR  REAL    FirmEnergy       INDEX DataOptfolio
	VECTOR	REAL 	FixedOEM         INDEX DataOptfolio
	VECTOR  REAL	CapRevenue       INDEX DataOptfolio
	VECTOR	REAL 	SensibPotInst	 INDEX DataSensib
	VECTOR  REFERENCE  Costs         Optfolio_GenericCosts
	PARM    INTEGER Included
	PARM	REAL	Percentage
	PARM	REAL	InternalLoss
	PARM	REAL	GridLoss
	PARM 	INTEGER Contract
	PARM	INTEGER	RevPfirm
	PARM	INTEGER	RevGF
	PARM	INTEGER DecisionType
	PARM	INTEGER DecisionVar
	PARM	DATE	MinCOD
	PARM	INTEGER CODInterval
	PARM	INTEGER	IsCandidate
	
// See later:	VECTOR	REAL	FixedOEMCost	DIM(block)
END_CLASS

//--------------------------------------
// --- Modelo de contrato            ---
//--------------------------------------
DEFINE_MODEL Optfolio_Contracts
  
  // -- Dynamic data -- //
  DIMENSION    block
  VETOR DATE   DataPrice
  VETOR DATE   DataQt
  VETOR DATE   DataHourQt     @hourly_dense
  VETOR DATE   DataHourPrice  @hourly_dense
  VETOR REAL   PriceTS        DIM(block) INDEX DataPrice
  VETOR REAL   QuantityTS     DIM(block) INDEX DataQt
  VETOR REAL   PriceHourTS    INDEX DataHourPrice
  VETOR REAL   QuantityHourTS INDEX DataHourQt
  
  // -- Static data -- //
  PARM STRING  Name @id
  PARM REAL    Price 
  PARM INTEGER PriceStructure
  PARM REAL    Quantity
  PARM INTEGER Unit
  PARM DATE    Start
  PARM DATE    End
  PARM INTEGER Seasonality
  PARM INTEGER Structure
  PARM INTEGER Category
  PARM DATE    Decision
  PARM REFERENCE System PSRSystem @id
  PARM REFERENCE Plant  PSRPlant  
  PARM REFERENCE PriceIndex	PSRIndexes	
  PARM INTEGER Included	

END_MODEL



//--------------------------------------
// --- Modelo de contrato Forward    ---
//--------------------------------------
DEFINE_CLASS Contract_Forward

	MERGE_MODEL Optfolio_Contracts
  
  // -- Static data -- //

  PARM REAL    Spread 
  PARM INTEGER SpreadUnit
  PARM INTEGER FlexFlag
  PARM INTEGER FlexDist
  PARM INTEGER FlexSide
  PARM REAL	   FlexUbound
  PARM REAL	   FlexLbound 
  PARM INTEGER Position
  
END_CLASS

//--------------------------------------
// --- Modelo de contrato ACR        ---
//--------------------------------------
DEFINE_CLASS Contract_Reserve

	MERGE_MODEL Optfolio_Contracts
  // -- Static data -- //
  PARM INTEGER Type
  
END_CLASS


//--------------------------------------
// --- Modelo de contrato Opcoes     ---
//--------------------------------------
DEFINE_CLASS Contract_Options

	MERGE_MODEL Optfolio_Contracts
  // -- Static data -- //
  PARM REAL    Strike
  PARM REAL    Premium
  PARM INTEGER Position
  
END_CLASS

//------------------------------------------
//--- Modelo de Configuracao do Optfolio ---
//------------------------------------------
MERGE_CLASS PSRStudy Optfolio_ConfiguracaoEstudo
	MERGE_MODEL Optfolio_Tree
	MERGE_MODEL Optfolio_GoalSeek
	MERGE_MODEL	Optfolio_OperateThermal

	PARM    INTEGER ExecutionMode
	PARM 	INTEGER RiskStatistic
	PARM	INTEGER	MoedaIn
	PARM	INTEGER	MoedaOut
	PARM	REFERENCE	MacroIndex	PSRIndexes	
	PARM	DATE	ReferenceDate
	PARM	REAL	DiscountRate
	PARM	REAL	ConfidenceLevel
    PARM	REAL	RiskAversity
	PARM	INTEGER	LimitSpotPrice
   	PARM	REAL	Cap
	PARM	REAL	Floor
	PARM	INTEGER Delay
	PARM 	INTEGER Overcost
	PARM	REAL	Vat
	PARM	REAL	IncomeTax
	PARM	REAL	DscrIndex
	PARM	STRING	DecisionType
	PARM    INTEGER OptResolution
	PARM    INTEGER SimulResolution
	PARM    INTEGER ConstraintShortSelling
	PARM	REAL	BallastPrice
	PARM	INTEGER	ExtendHorizon
	PARM	INTEGER	RandomHorizon
	PARM	INTEGER	JumpStages
	PARM	INTEGER FlagFileDate
	PARM	INTEGER	FlagOptcontract
	PARM	STRING	PathOptcontract
	PARM	INTEGER	BallastPrem
	PARM	INTEGER OptgPfirme
	PARM	INTEGER OptgEfirme
	PARM	INTEGER OptgInstCap
	PARM	INTEGER FlagNegPrem
	PARM	INTEGER FlagAllPrem
	PARM	REAL	SpreadAutoCtr
	VECTOR  INTEGER ScenarioSelect
END_CLASS


//-------------------------------------------
// Modelo para Restricao de Exclusividade ---
//-------------------------------------------
DEFINE_CLASS PSRConstraintExcludent
	PARM	STRING  	Name @id
	PARM   	INTEGER		Included
	VECTOR 	REFERENCE 	Plants    PSRPlant
	VECTOR 	REFERENCE 	Contracts PSRElement
END_CLASS


//-------------------------------------------
// Modelo para Restricao Associativa      ---
//-------------------------------------------
DEFINE_CLASS PSRConstraintAssociative
	PARM 	STRING  	Name @id
	PARM	INTEGER		Window
	PARM   	INTEGER		Included
	VECTOR 	REFERENCE 	Plants    PSRPlant
	VECTOR 	REFERENCE 	Contracts PSRElement
END_CLASS

//-------------------------------------------
//--- Modelo para Restricoes do Portfolio ---
//-------------------------------------------
DEFINE_CLASS PSRConstraintPortfolio
	PARM 	STRING  	Name @id
	PARM 	DATE		DataMin
	PARM 	DATE		DataMax
	PARM 	REAL		ConstraintPort
	PARM 	REAL		Alpha
	PARM 	INTEGER		Type
	PARM 	INTEGER		Included
	VECTOR 	REFERENCE 	Portfolios PSRPortfolio
END_CLASS

//-------------------------------------------
//--- Modelo para Restricoes de Contratos ---
//-------------------------------------------
DEFINE_CLASS PSRConstraintContract
	PARM 	STRING  	Name @id
	PARM 	DATE	 	DataMin
	PARM 	DATE	 	DataMax
	PARM 	REAL	 	ConstraintCtrs
	PARM 	INTEGER 	Position
	PARM 	INTEGER		Unit
	PARM 	INTEGER		LimitType
	PARM 	INTEGER		Included
	VECTOR 	REFERENCE 	Portfolios PSRPortfolio
END_CLASS

//-------------------------------------------
//--- Modelo para Restricoes de Capacidade --
//-------------------------------------------
DEFINE_CLASS PSRConstraintCapacity
	PARM 	STRING  	Name @id
	PARM 	DATE		DataMin
	PARM 	DATE		DataMax
	PARM 	REAL		Value
	PARM 	INTEGER		Unit
	PARM 	INTEGER		Type
	PARM 	INTEGER		Included
	VECTOR 	REFERENCE 	Portfolios PSRPortfolio
END_CLASS

//-------------------------------------------
//---- Modelo para Restricoes de Budget -----
//-------------------------------------------
DEFINE_CLASS PSRConstraintBudget
	PARM 	STRING  	Name @id
	PARM 	DATE		DataMin
	PARM 	DATE		DataMax
	PARM 	REAL		Value
	PARM 	INTEGER		Scale
	PARM 	INTEGER		Type
	PARM 	INTEGER		Included
	VECTOR 	REFERENCE 	Portfolios PSRPortfolio
END_CLASS

//-------------------------------------------
//---  rvore de decis es      ---
//-------------------------------------------
DEFINE_MODEL Optfolio_Tree
	PARM	INTEGER	treeType
	PARM	INTEGER	initialSplit
	PARM	INTEGER	numNodeSons
	PARM	INTEGER	splitStep
	PARM	INTEGER	maxSplits
	PARM 	REFERENCE System PSRSystem
END_MODEL

//-------------------------------------------
//--- Modelo para Goal Seek               ---
//-------------------------------------------
DEFINE_MODEL Optfolio_GoalSeek
	PARM	INTEGER	useGoalSeek
	PARM	INTEGER gsType
	PARM	REAL	gsTarget
	PARM	REAL	gsPrecision
	PARM	INTEGER	gsMetricEval
	PARM 	REFERENCE Contract PSRElement
END_MODEL

//-------------------------------------------
//--- Modelo para Custos Genericos        ---
//-------------------------------------------
DEFINE_CLASS Optfolio_GenericCosts
	DIMENSION	block
	
	PARM	STRING		name @id
	PARM	INTEGER 	unit
	PARM 	REFERENCE 	PriceIndex	PSRIndexes
	PARM    INTEGER     isrevenue
	
	VETOR 	DATE   	DataCost
	VECTOR  REAL    marginalvalue  INDEX DataCost
END_CLASS

//----------------------------------------
//--- Modelo de selecao de portfolios  ---
//----------------------------------------
DEFINE_CLASS PSRPortfolio
	PARM 	STRING    portfolioName @id
	VECTOR  REFERENCE Plants    PSRPlant
	VECTOR  REFERENCE Contracts PSRElement
	VECTOR  REFERENCE Taxes		Optfolio_GenericTaxes
	PARM	INTEGER	  Included
END_CLASS

//--------------------------------------
//--- Modelo de Emprestimo           ---
//--------------------------------------
DEFINE_CLASS PSRLoan 
	PARM	STRING	Name @id
	PARM	INTEGER	InterestStruct
	PARM	INTEGER	InterestType
	PARM	REAL	InterestRate
	PARM	INTEGER	Maturity
	PARM	INTEGER	MaturityUnit 
	PARM	INTEGER	Repayment
	PARM	INTEGER	Grace
	PARM	INTEGER	GraceInterest
	PARM	INTEGER	DisbMethod
	PARM 	REFERENCE 	MacroIndex	PSRIndexes	
		
END_CLASS

//--------------------------------------
//--- Modelo de Projetos             ---
//--------------------------------------
MERGE_CLASS PSRExpansionProject Optfolio_Projects
	PARM	REAL		Equity
	PARM	INTEGER		Depreciation
	VECTOR 	REAL    	Probabilities
	VECTOR 	REAL    	DelayStages		
	VECTOR 	REAL    	OvercostFactors	
	PARM 	REFERENCE 	Loan		PSRLoan
	PARM 	REFERENCE 	MacroIndex	PSRIndexes
END_CLASS

//----------------------------------------
//--- Modelo de selecao de indices     ---
//----------------------------------------
DEFINE_CLASS PSRIndexes
	PARM  	STRING  name @id 
	PARM	INTEGER	unit
	
	VECTOR 	DATE   	DataIndex
	VECTOR  REAL    MacroIndex	INDEX DataIndex
END_CLASS


//-------------------------------------------
//--- Modelo para Taxas Genericas        ---
//-------------------------------------------
DEFINE_CLASS Optfolio_GenericTaxes
	PARM	STRING		name @id
	PARM	REAL 		base
	PARM	INTEGER 	baseDRE
	PARM	REAL		rate
END_CLASS

//-------------------------------------------
//--- Modelo para Taxas Genericas        ---
//-------------------------------------------
DEFINE_MODEL Optfolio_OperateThermal
	PARM	INTEGER		RunOption 
	PARM	INTEGER		DataFormat 
	PARM	REAL 		OperCost
	PARM	REAL		TakeOrPay
	PARM	REAL		Contracted
	
	PARM	REFERENCE	Thermal			PSRThermalPlant
	PARM	REFERENCE	Availb_Contract	Contract_Reserve
END_MODEL